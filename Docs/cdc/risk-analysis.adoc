= BlaBlaBook V2 - Risk Analysis & GDPR / Analyse des Risques & RGPD
:toc: left
:toclevels: 3
:sectanchors:
:icons: font
:version: 2.0
:date: {docdate}

// Navigation inter-documents
link:../README.adoc[üìö Documentation Hub] |
link:business-requirements.adoc[üìã Business] |
link:technical-architecture.adoc[üèóÔ∏è Architecture] |
link:api-specifications.adoc[üõ£Ô∏è API]

// Navigation langues
<<section-fr,üá´üá∑ Version Fran√ßaise>> | <<section-en,üá¨üáßüá∫üá∏ English Version>>

---

[[section-fr]]
== üá´üá∑ Analyse des Risques & RGPD

<<section-en,üá¨üáßüá∫üá∏ Switch to English>> | üá´üá∑ *Fran√ßais*

=== ‚ö†Ô∏è Analyse des Risques

==== API et Services Externes

[cols="2,1,1,3"]
|===
|Risque |Probabilit√© |Impact |Mitigation V2

|**API Open Library indisponible**
|Faible
|Fort
|Cache local + message d'erreur utilisateur + livres par d√©faut

|**Quotas API d√©pass√©s**
|Moyenne
|Moyen
|Rate limiting c√¥t√© client + cache intelligent + pagination

|**Donn√©es incorrectes API**
|Moyenne
|Faible
|Validation Drizzle-Zod + nettoyage donn√©es + signalement erreurs
|===

==== Base de Donn√©es

[cols="2,1,1,3"]
|===
|Risque |Probabilit√© |Impact |Mitigation V2

|**Perte de donn√©es PostgreSQL**
|Faible
|Fort
|Sauvegardes automatis√©es + r√©plication + environnement de test

|**Probl√®mes de performance**
|Moyenne
|Moyen
|Index Drizzle optimis√©s + pagination + cache queries

|**Corruption de donn√©es**
|Tr√®s faible
|Fort
|Transactions ACID + validation sch√©ma + monitoring int√©grit√©
|===

==== S√©curit√©

[cols="2,1,1,3"]
|===
|Risque |Probabilit√© |Impact |Mitigation V2

|**Compromission JWT**
|Moyenne
|Fort
|Rotation cl√©s + tokens courte dur√©e + blacklist client + monitoring

|**Attaques brute force**
|Forte
|Moyen
|Rate limiting Deno + Argon2 + captcha apr√®s √©checs + logs

|**Injection de donn√©es**
|Faible
|Fort
|Drizzle ORM + validation Drizzle-Zod + sanitisation + tests s√©curit√©

|**Failles XSS/CSRF**
|Faible
|Moyen
|Headers Helmet + SameSite cookies + Content-Type validation
|===

==== Infrastructure

[cols="2,1,1,3"]
|===
|Risque |Probabilit√© |Impact |Mitigation V2

|**Probl√®mes d√©ploiement Docker**
|Moyenne
|Moyen
|Docker Compose test√© + documentation + rollback automatique

|**Panne serveur unique**
|Moyenne
|Fort
|Load balancer + r√©plication + monitoring + alertes

|**Probl√®mes SSL/HTTPS**
|Faible
|Moyen
|Certificats auto-renouvel√©s + monitoring SSL + redirections forc√©es
|===

=== ‚öñÔ∏è RGPD (R√®glement G√©n√©ral sur la Protection des Donn√©es)

==== 1. Inventaire des Donn√©es Personnelles

**Donn√©es collect√©es :**

[cols="2,1,2,2"]
|===
|Type de Donn√©e |N√©cessit√© |Base L√©gale |Dur√©e Conservation

|**Nom, pr√©nom, email**
|Essentielle
|Ex√©cution du contrat
|Jusqu'√† suppression compte

|**Nom d'utilisateur**
|Essentielle
|Ex√©cution du contrat
|Jusqu'√† suppression compte

|**Mot de passe (hach√© Argon2)**
|Essentielle
|Ex√©cution du contrat
|Jusqu'√† suppression compte

|**Listes de livres, avis**
|Fonctionnelle
|Ex√©cution du contrat
|Jusqu'√† suppression compte

|**Adresse IP, logs connexion**
|S√©curit√©
|Int√©r√™t l√©gitime
|30 jours maximum

|**Donn√©es utilisation (statistiques)**
|Am√©lioration
|Consentement
|Anonymis√©es apr√®s 12 mois
|===

==== 2. Politique de Confidentialit√©

**√âl√©ments obligatoires :**

* **Responsable du traitement** : √âquipe BlaBlaBook (contact DPO)
* **Finalit√©s des traitements** :
  - Inscription et authentification s√©curis√©e
  - Gestion biblioth√®que personnelle et listes de lecture
  - Partage d'avis et recommandations
  - Am√©lioration continue du service
* **Bases l√©gales** : Contrat utilisateur + consentement fonctionnalit√©s optionnelles
* **Destinataires** : Donn√©es non transmises √† des tiers
* **Transferts hors UE** : Aucun (h√©bergement UE uniquement)
* **Dur√©e de conservation** : Voir tableau ci-dessus

==== 3. Droits des Utilisateurs

**Impl√©mentation technique :**

[cols="2,3,2"]
|===
|Droit RGPD |Impl√©mentation API |D√©lai R√©ponse

|**Droit d'acc√®s**
|`GET /api/user/export` - Export JSON complet
|Imm√©diat (automatis√©)

|**Droit de rectification**
|`PUT /api/user/profile` - Modification profil
|Imm√©diat (automatis√©)

|**Droit √† l'effacement**
|`DELETE /api/user/account` - Suppression compte + donn√©es
|Imm√©diat (automatis√©)

|**Droit √† la portabilit√©**
|Export JSON structur√© (format standard)
|Imm√©diat (automatis√©)

|**Droit d'opposition**
|Param√®tres compte + d√©sinscription newsletters
|Imm√©diat (automatis√©)

|**Droit de limitation**
|Suspension temporaire traitement (admin)
|24h maximum
|===

==== 4. Consentement et Transparence

**M√©canismes de consentement :**

* **Inscription** : Acceptation explicite des CGU et politique confidentialit√©
* **Cookies non-essentiels** : Banner RGPD avec choix granulaire
* **Newsletters** : Opt-in explicite + double confirmation
* **Statistiques** : Consentement s√©par√© avec possibilit√© retrait

**Information des utilisateurs :**

* Politique de confidentialit√© accessible (lien permanent footer)
* Notifications des modifications importantes (email + interface)
* Tableau de bord RGPD dans param√®tres compte
* Documentation claire sur collecte et utilisation donn√©es

==== 5. S√©curit√© des Donn√©es

**Mesures techniques V2 :**

[cols="2,3"]
|===
|Mesure |Impl√©mentation

|**Chiffrement en transit**
|HTTPS forc√© + TLS 1.3 + HSTS

|**Chiffrement au repos**
|PostgreSQL avec encryption + mots de passe Argon2

|**Contr√¥le d'acc√®s**
|JWT avec r√¥les + permissions granulaires Deno

|**Audit et logs**
|Logs s√©curis√©s + monitoring acc√®s + alertes anomalies

|**Sauvegarde s√©curis√©e**
|Backups chiffr√©s + tests restauration + r√©tention limit√©e

|**Mise √† jour s√©curit√©**
|Deno auto-update + monitoring vuln√©rabilit√©s + patch management
|===

==== 6. Registre des Traitements

**Traitement principal - Gestion biblioth√®que personnelle :**

* **Finalit√©** : Permettre aux utilisateurs de g√©rer leurs livres et listes de lecture
* **Cat√©gories de personnes** : Utilisateurs inscrits volontaires
* **Donn√©es trait√©es** : Identit√©, authentification, pr√©f√©rences de lecture
* **Destinataires** : √âquipe technique BlaBlaBook uniquement
* **Transferts** : Aucun transfert hors UE
* **D√©lais suppression** : Suppression imm√©diate sur demande utilisateur
* **Mesures s√©curit√©** : Voir section 5 ci-dessus

==== 7. Gestion des Cookies

**Classification cookies :**

[cols="2,1,2,2"]
|===
|Cookie |Type |Finalit√© |Dur√©e

|**Session JWT**
|Essentiel
|Authentification utilisateur
|8h (access uniquement, httpOnly cookie)

|**Pr√©f√©rences UI**
|Essentiel
|Interface utilisateur (langue, th√®me)
|1 an

|**Analytics (optionnel)**
|Non-essentiel
|Statistiques d'utilisation anonymes
|13 mois (avec consentement)

|**Marketing (futur)**
|Non-essentiel
|Recommandations personnalis√©es
|Avec consentement explicite
|===

**Gestionnaire de consentement :**
* Banner conforme CNIL avec rejet facile
* Choix granulaire par cat√©gorie
* Modification consentement accessible (param√®tres)
* Conservation preuve du consentement

==== 8. Violations de Donn√©es

**Proc√©dure de notification :**

1. **D√©tection** : Monitoring automatique + alertes temps r√©el
2. **√âvaluation** : Impact sur droits et libert√©s (72h max)
3. **Notification CNIL** : Si risque √©lev√© (72h apr√®s d√©tection)
4. **Information utilisateurs** : Si risque √©lev√© pour leurs droits (sans d√©lai injustifi√©)
5. **Documentation** : Registre des violations + mesures correctives

**Mesures pr√©ventives V2 :**
* Monitoring s√©curit√© 24/7
* Tests d'intrusion r√©guliers
* Formation √©quipe aux bonnes pratiques
* Plan de r√©ponse aux incidents document√©

---

[[section-en]]
== üá¨üáßüá∫üá∏ Risk Analysis & GDPR

üá¨üáßüá∫üá∏ *English* | <<section-fr,üá´üá∑ Passer au Fran√ßais>>

=== ‚ö†Ô∏è Risk Analysis

==== API and External Services

[cols="2,1,1,3"]
|===
|Risk |Probability |Impact |V2 Mitigation

|**Open Library API unavailable**
|Low
|High
|Local cache + user error message + default books

|**API quotas exceeded**
|Medium
|Medium
|Client-side rate limiting + intelligent cache + pagination

|**Incorrect API data**
|Medium
|Low
|Drizzle-Zod validation + data cleaning + error reporting
|===

==== Database

[cols="2,1,1,3"]
|===
|Risk |Probability |Impact |V2 Mitigation

|**PostgreSQL data loss**
|Low
|High
|Automated backups + replication + test environment

|**Performance issues**
|Medium
|Medium
|Optimized Drizzle indexes + pagination + query cache

|**Data corruption**
|Very Low
|High
|ACID transactions + schema validation + integrity monitoring
|===

==== Security

[cols="2,1,1,3"]
|===
|Risk |Probability |Impact |V2 Mitigation

|**JWT compromise**
|Medium
|High
|Key rotation + short-lived tokens + client blacklist + monitoring

|**Brute force attacks**
|High
|Medium
|Deno rate limiting + Argon2 + captcha after failures + logs

|**Data injection**
|Low
|High
|Drizzle ORM + Drizzle-Zod validation + sanitization + security tests

|**XSS/CSRF vulnerabilities**
|Low
|Medium
|Helmet headers + SameSite cookies + Content-Type validation
|===

==== Infrastructure

[cols="2,1,1,3"]
|===
|Risk |Probability |Impact |V2 Mitigation

|**Docker deployment issues**
|Medium
|Medium
|Tested Docker Compose + documentation + automatic rollback

|**Single server failure**
|Medium
|High
|Load balancer + replication + monitoring + alerts

|**SSL/HTTPS issues**
|Low
|Medium
|Auto-renewed certificates + SSL monitoring + forced redirects
|===

=== ‚öñÔ∏è GDPR (General Data Protection Regulation)

==== 1. Personal Data Inventory

**Collected data:**

[cols="2,1,2,2"]
|===
|Data Type |Necessity |Legal Basis |Retention Period

|**Name, surname, email**
|Essential
|Contract execution
|Until account deletion

|**Username**
|Essential
|Contract execution
|Until account deletion

|**Password (Argon2 hashed)**
|Essential
|Contract execution
|Until account deletion

|**Book lists, reviews**
|Functional
|Contract execution
|Until account deletion

|**IP address, connection logs**
|Security
|Legitimate interest
|30 days maximum

|**Usage data (statistics)**
|Improvement
|Consent
|Anonymized after 12 months
|===

==== 2. Privacy Policy

**Mandatory elements:**

* **Data controller** : BlaBlaBook Team (DPO contact)
* **Processing purposes** :
  - Secure registration and authentication
  - Personal library and reading list management
  - Review and recommendation sharing
  - Continuous service improvement
* **Legal bases** : User contract + consent for optional features
* **Recipients** : No data transmitted to third parties
* **Non-EU transfers** : None (EU hosting only)
* **Retention periods** : See table above

==== 3. User Rights

**Technical implementation:**

[cols="2,3,2"]
|===
|GDPR Right |API Implementation |Response Time

|**Right of access**
|`GET /api/user/export` - Complete JSON export
|Immediate (automated)

|**Right of rectification**
|`PUT /api/user/profile` - Profile modification
|Immediate (automated)

|**Right to erasure**
|`DELETE /api/user/account` - Account + data deletion
|Immediate (automated)

|**Right to portability**
|Structured JSON export (standard format)
|Immediate (automated)

|**Right to object**
|Account settings + newsletter unsubscribe
|Immediate (automated)

|**Right to restriction**
|Temporary processing suspension (admin)
|24h maximum
|===

==== 4. Consent and Transparency

**Consent mechanisms:**

* **Registration** : Explicit acceptance of T&C and privacy policy
* **Non-essential cookies** : GDPR banner with granular choice
* **Newsletters** : Explicit opt-in + double confirmation
* **Statistics** : Separate consent with withdrawal option

**User information:**

* Privacy policy accessible (permanent footer link)
* Important change notifications (email + interface)
* GDPR dashboard in account settings
* Clear documentation on data collection and use

==== 5. Data Security

**V2 technical measures:**

[cols="2,3"]
|===
|Measure |Implementation

|**Encryption in transit**
|Forced HTTPS + TLS 1.3 + HSTS

|**Encryption at rest**
|PostgreSQL with encryption + Argon2 passwords

|**Access control**
|JWT with roles + granular Deno permissions

|**Audit and logs**
|Secure logs + access monitoring + anomaly alerts

|**Secure backup**
|Encrypted backups + restoration tests + limited retention

|**Security updates**
|Deno auto-update + vulnerability monitoring + patch management
|===

==== 6. Processing Records

**Main processing - Personal library management:**

* **Purpose** : Allow users to manage their books and reading lists
* **Data subjects** : Voluntary registered users
* **Data processed** : Identity, authentication, reading preferences
* **Recipients** : BlaBlaBook technical team only
* **Transfers** : No transfers outside EU
* **Deletion deadlines** : Immediate deletion on user request
* **Security measures** : See section 5 above

==== 7. Cookie Management

**Cookie classification:**

[cols="2,1,2,2"]
|===
|Cookie |Type |Purpose |Duration

|**JWT Session**
|Essential
|User authentication
|8h (access only, httpOnly cookie)

|**UI Preferences**
|Essential
|User interface (language, theme)
|1 year

|**Analytics (optional)**
|Non-essential
|Anonymous usage statistics
|13 months (with consent)

|**Marketing (future)**
|Non-essential
|Personalized recommendations
|With explicit consent
|===

**Consent management:**
* CNIL-compliant banner with easy rejection
* Granular choice by category
* Accessible consent modification (settings)
* Consent proof conservation

==== 8. Data Breaches

**Notification procedure:**

1. **Detection** : Automatic monitoring + real-time alerts
2. **Assessment** : Impact on rights and freedoms (72h max)
3. **CNIL notification** : If high risk (72h after detection)
4. **User information** : If high risk to their rights (without undue delay)
5. **Documentation** : Breach register + corrective measures

**V2 preventive measures:**
* 24/7 security monitoring
* Regular penetration testing
* Team training on best practices
* Documented incident response plan

---

*Document cr√©√© le {14/09/2025} - Version {V1} - Generated on {2025/09/14} - Version {V1}*